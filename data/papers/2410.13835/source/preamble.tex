\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts

% \usepackage{times}
% \usepackage{parskip}

\usepackage{subcaption}
% \usepackage[font=small,labelfont=bf]{caption}
% \newcommand\hmmax{0}
% \newcommand\bmmax{0}

%% Math
\usepackage{amsmath}
\usepackage{amsfonts,amscd,amssymb,bm,bbm,mathrsfs}
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{amsthm}
% thmtools,thm-restate}
% \usepackage[thmmarks, amsmath, thref, amsthm]{ntheorem}
\usepackage{mathtools}

% This package controls font of math
% \usepackage{mathabx}
% This package removes ~ space in equations
% \usepackage{amsxtra}

% Restate equation
% Suggestion: use these commands inside aligned environment
\newcommand\labelAndRemember[2]
  {\expandafter\gdef\csname labeled:#1\endcsname{#2}%
   \label{#1}#2}
\newcommand\recallLabel[1]
   {\csname labeled:#1\endcsname\tag{\ref{#1}}}
\newcommand\labelr[2]
  {\expandafter\gdef\csname labeled:#1\endcsname{#2}%
   \label{#1}#2}
\newcommand\recall[1]
   {\csname labeled:#1\endcsname}

%% Algorithm
\usepackage[algo2e,linesnumbered,vlined,ruled]{algorithm2e}
\usepackage{algorithm}
\usepackage[noend]{algorithmic}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

%% Basics
\usepackage{url}
\usepackage{hyperref}
% \usepackage{breakcites}
% \usepackage[usenames,dvipsnames]{color}
\hypersetup{
  colorlinks,
  breaklinks=true,
  citecolor=blue!70!black,
  linkcolor=blue!70!black,
 %  urlcolor=blue!70!black
}
\usepackage[capitalise]{cleveref}
\usepackage[titletoc,title]{appendix}
\usepackage{cancel}
\usepackage{enumerate}
\usepackage[shortlabels]{enumitem}
\usepackage{comment}
\crefformat{equation}{#2(#1)#3}
\Crefformat{equation}{#2(#1)#3}
\crefformat{figure}{Figure #2#1#3}
\Crefformat{figure}{Figure #2#1#3}

%% Table
\usepackage{booktabs}       % professional-quality tables
\usepackage{multirow}
\usepackage{multicol}
\usepackage{makecell}
\usepackage{array}
\newcolumntype{H}{>{\setbox0=\hbox\bgroup}c<{\egroup}@{}}
\newcolumntype{Z}{>{\setbox0=\hbox\bgroup}c<{\egroup}@{\hspace*{-\tabcolsep}}}

%% Display
% \usepackage[usenames,dvipsnames]{color}
% \usepackage[dvipsnames]{xcolor}
\usepackage[normalem]{ulem}
\usepackage{exscale}
\usepackage{tikz}
\usepackage{float}
\usepackage{graphicx,graphics}
% subfig}
\graphicspath{ {./fig/} }
\allowdisplaybreaks

%% Theorems
% \usepackage{chngcntr}
% \usepackage{apptools}
% \makeatletter
% \def\thm@space@setup{\thm@preskip=3pt
% \thm@postskip=0pt}
% \makeatother
% \newtheorem{theorem}{Theorem}
% \newtheorem{lemma}[theorem]{Lemma}
% \newtheorem{corollary}[theorem]{Corollary}
% \newtheorem{proposition}[theorem]{Proposition}
% \newtheorem{definition}[theorem]{Definition}
% \newtheorem{assumption}[theorem]{Assumption}
% \theoremstyle{definition}
% \newtheorem{remark}[theorem]{Remark}
% \newtheorem{example}[theorem]{Example}

% \AtAppendix{\theoremstyle{theorem}
% \renewtheorem{lemma}{Lemma}[section]
% \renewtheorem{corollary}{Corollary}[section]
% \renewtheorem{proposition}{Proposition}[section]
% \renewtheorem{definition}{Definition}[section]
% \renewtheorem{assumption}{Assumption}[section]
% \theoremstyle{definition}
% \renewtheorem{remark}{Remark}[section]
% \renewtheorem{example}{Example}[section]}



%%% New theorem environment
% Proof environments
% The Theorems are numbered consecutively
% Lemmas are numbered by section, and observations, claims, facts, and 
% assumptions take their numbering. Propositions and definitions have their
% own numbering by section.
% \newtheorem{theorem}{Theorem}[section]
\newtheorem{theorem}{Theorem}
\newtheorem{claim}{Claim}
\newtheorem*{theorem*}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
% \newtheorem{ass}{Assumption}[section]
\newtheorem{remark}[theorem]{Remark}
\newtheorem*{remark*}{Remark}
\newtheorem*{lemma*}{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{observation}[theorem]{Observation}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{fact}[theorem]{Fact}
\newtheorem{assumption}{Assumption}
\renewcommand{\theassumption}{\Alph{assumption}}
\newtheorem{conjecture}[theorem]{Conjecture}


\newcommand{\exend}{{~$\Diamond$}}

\newenvironment{proof-sketch}{\noindent{\bf Proof Sketch}
  \hspace*{1em}}{\qed\bigskip\\}
\newenvironment{proof-idea}{\noindent{\bf Proof Idea}
  \hspace*{1em}}{\qed\bigskip\\}
\newenvironment{proof-of}[1][{}]{\noindent{\bf Proof of \cref{#1}}
  \hspace*{1em}}{\qed\bigskip\\}
\newenvironment{proof-of-lemma}[1][{}]{\noindent{\bf Proof of Lemma {#1}}
  \hspace*{1em}}{\qed\bigskip\\}
\newenvironment{proof-of-proposition}[1][{}]{\noindent{\bf
    Proof of Proposition {#1}}
  \hspace*{1em}}{\qed\bigskip\\}
\newenvironment{proof-of-theorem}[1][{}]{\noindent{\bf Proof of Theorem {#1}}
  \hspace*{1em}}{\qed\bigskip\\}
\newenvironment{inner-proof}{\noindent{\bf Proof}\hspace{1em}}{
  $\bigtriangledown$\medskip\\}
%% \newenvironment{proof-of-lemma}[1][{}]{\noindent{\bf Proof of Lemma {#1}}
%%   \hspace*{1em}\renewcommand{\qedsymbol}{$\bigtriangledown$}}{\qed\bigskip\\}
\newenvironment{proof-attempt}{\noindent{\bf Proof Attempt}
  \hspace*{1em}}{\qed\bigskip\\}
%\newenvironment{proofof}[1]{\noindent{\bf Proof} of {#1}: \hspace*{1em}}{\qed\bigskip\\}
\newenvironment{proofof}[1][{}]{\noindent{\bf Proof of \cref{#1}}
  \hspace*{1em}}{\qed\bigskip\\}
  
% \theoremsymbol{\ensuremath{\square}}
% \newtheorem{proof}{Proof}
%restate
\newenvironment{thmbis}[1]
  {\renewcommand{\thetheorem}{\ref{#1}$'$}%
   \addtocounter{theorem}{-1}%
   \begin{theorem}}
  {\end{theorem}}


\newcommand{\comm}[1]{{\color{red}#1}}
\newcommand{\revise}[1]{{\color{blue}#1}}
\newcommand{\remove}[1]{{\color{Gray}\sout{#1}}}
      
%% ------------------------------------------------
%% ----------------Math symbols----------------
%% ------------------------------------------------
\renewcommand{\hat}{\widehat}
\renewcommand{\bar}{\overline}
\renewcommand{\epsilon}{\varepsilon}

\usepackage{pifont}
% \newcommand{\yes}{\checkmark}
\newcommand{\no}{\ding{55}}
\newcommand{\yes}{\ding{51}}
%\newcommand{\id}{I}
\newcommand{\id}{\bI}
\newcommand{\tA}{\tilde{\mathcal{A}}} 
\newcommand{\tC}{\tilde{C}}  
\newcommand{\tX}{\tilde{X}}    
\newcommand{\tZ}{\tilde{Z}} 
\newcommand{\tM}{\tilde{M}}
% \newcommand{\cL}{\mathcal{L}}
% \newcommand{\cO}{\mathcal{O}}
\newcommand{\nS}{|\mathcal{S}|}
\newcommand{\nA}{|\mathcal{A}|}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\eps}{\varepsilon}
\newcommand{\Eps}{\mathcal{E}}
\newcommand{\hX}{X}
\newcommand{\hY}{Y}
\newcommand{\hZ}{Z}
% \newcommand{\II}[1]{\mathbb{1}\left\{#1\right\}}
\newcommand{\II}{\mathbb{I}}
\newcommand{\EE}{\mathbb{E}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\VV}{\mathbb{V}}
\newcommand{\DD}{\mathbb{D}}
% set \cL \bL 
\newcounter{cnt}
\setcounter{cnt}{0}
\foreach \num in {1,2,...,26}{%
  \stepcounter{cnt}%
  \expandafter\xdef \csname c\Alph{cnt}\endcsname {\noexpand\mathcal{\Alph{cnt}}}%
  \expandafter\xdef \csname b\Alph{cnt}\endcsname {\noexpand\mathbb{\Alph{cnt}}}%
}
\renewcommand{\bR}{\mathbf{R}}
\newcommand{\br}{\mathbf{r}}
%% ------------------------------------------------
%% ----------------Mathrm----------------
%% ------------------------------------------------
\newcommand{\tr}{\mathrm{tr}}
\newcommand{\im}{\operatorname{Im}}
\newcommand{\ind}{\mathrm{1}}
\newcommand{\sgn}{\mathrm{sgn}} 
\newcommand{\spa}{\mathrm{span}} 
\newcommand{\orth}{\mathbf{orth}} 
\newcommand{\prox}{\mathbf{prox}} 
\newcommand{\ket}[1]{\left\vert{#1}\right\rangle}
\newcommand{\bra}[1]{\left\langle{#1}\right\vert}
\newcommand{\braket}[2]{\left\langle{#1}\vert{#2}\right\rangle}
\newcommand{\dom}{\mathrm{dom}} 
\newcommand{\dist}{\mathrm{dist}} 
\newcommand{\ivec}{\mathrm{vec}}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\diam}{diam}
\newcommand{\Proj}{\operatorname{Proj}}
\newcommand{\diag}{\operatorname{diag}}
\newcommand{\TV}{\operatorname{TV}}


\newcommand{\leqsim}{\lesssim}
\newcommand{\geqsim}{\gtrsim}
\newcommand{\minimize}{\mathop{\textrm{minimize}}}
\newcommand{\maximize}{\mathop{\textrm{maximize}}}
\newcommand{\st}{\mathop{\textrm{s.t.}\ }}  
\newcommand{\T}{\top}  
\newcommand{\iprod}[2]{\left\langle #1, #2 \right\rangle}
\newcommand{\nrm}[1]{\left\|#1\right\|}
\newcommand{\minop}[1]{\min\left\{#1\right\}}
% \newcommand{\maxop}[1]{\max\left\{#1\right\}}
\newcommand{\abs}[1]{\left|#1\right|}
\newcommand{\sqr}[1]{\left\|#1\right\|^2}
\newcommand{\prob}[1]{\mathbb{P}\left(#1\right)}
\newcommand{\epct}[1]{\mathbb{E}\left[#1\right]}
\newcommand{\cond}[2]{\mathbb{E}\left[\left.#1\right|#2\right]}
\newcommand{\condP}[2]{\mathbb{P}\left(\left.#1\right|#2\right)}
\newcommand{\condV}[2]{\mathbb{V}\left[\left.#1\right|#2\right]}
\newcommand{\bigO}[1]{\mathcal{O}\left(#1\right)}
% \newcommand{\tbO}[1]{\tilde{\mathcal{O}}\left(#1\right)}
\newcommand{\tbO}[1]{\widetilde{\mathcal{O}}\left(#1\right)}
\newcommand{\tbbO}[1]{\tilde{\mathcal{O}}\big(#1\big)}
\newcommand{\tbOm}[1]{\tilde{\Omega}\left(#1\right)}
\newcommand{\Om}[1]{\Omega\left(#1\right)}
\newcommand{\ThO}[1]{\Theta\left(#1\right)}
\newcommand{\ceil}[1]{\left\lceil #1\right\rceil}
\newcommand{\floor}[1]{\left\lfloor #1\right\rfloor}
% \newcommand{\KL}[2]{\operatorname{KL}\left(\left.#1\right|\right)}
\DeclarePairedDelimiterX{\ddiv}[2]{(}{)}{%
  #1\;\delimsize\|\;#2%
}
\newcommand{\KL}{\operatorname{KL}\ddiv}
% \newcommand{\Dtwo}{\operatorname{D}_2\ddiv}
\newcommand{\Dtwo}{\operatorname{D}_{\chi^2}\ddiv}
\newcommand{\pos}[1]{\left[#1\right]_{+}}
% \renewcommand{\neg}[1]{\left[#1\right]_{-}}
% \newcommand{\Om}[1]{\Omega\left(#1\right)}
\newcommand{\hnabla}{\widehat{\nabla}}
% \newcommand{\TV}{\mathrm{TV}}
\newcommand{\Unif}{\mathrm{Unif}}
\newcommand{\Fil}{\mathfrak{F}}

\newcommand{\Algo}{\mathfrak{A}}
\newcommand{\condPt}[2]{\mathbb{P}_{\theta}\left(\left.#1\right|#2\right)}
\newcommand{\condPb}[2]{\mathbb{P}_{\pi_b}\left(\left.#1\right|#2\right)}

% Norms for convenience, along with sizes
\newcommand{\norm}[1]{\left\|{#1}\right\|} % A norm with 1 argument
\newcommand{\lone}[1]{\norm{#1}_1} % l1 norm
\newcommand{\ltwo}[1]{\norm{#1}_2} % l2 norm
\newcommand{\lop}[1]{\norm{#1}_{\mathrm{op}}}
\newcommand{\lops}[1]{\|{#1}\|_{\mathrm{op}}}
\newcommand{\linf}[1]{\norm{#1}_\infty} % l-infinity norm
\newcommand{\lzero}[1]{\norm{#1}_0} % l0 norm
\newcommand{\dnorm}[1]{\norm{#1}_*} % Dual norm
\newcommand{\lfro}[1]{\left\|{#1}\right\|_{\sf Fr}} % Frobenius norm
\newcommand{\lnuc}[1]{\left\|{#1}\right\|_*} % Nuclear norm
\newcommand{\matrixnorm}[1]{\left|\!\left|\!\left|{#1}
  \right|\!\right|\!\right|} % Matrix norm with three bars
\newcommand{\opnorm}[1]{\norm{#1}_{\rm op}} % Operator norm with three bars
\newcommand{\normbigg}[1]{\bigg\|{#1}\bigg\|} % A norm with 1 argument and bigg
                                              % brackets.
\newcommand{\normbig}[1]{\big\|{#1}\big\|} % A norm with 1 argument and big
                                           % brackets.
\newcommand{\normBig}[1]{\Big\|{#1}\Big\|} % A norm with 1 argument and Big
                                           % brackets
\newcommand{\lonebigg}[1]{\normbigg{#1}_1} % l1 norm
\newcommand{\ltwobigg}[1]{\normbigg{#1}_2} % l2 norm
\newcommand{\ltwobig}[1]{\normbig{#1}_2} % l2 norm
\newcommand{\ltwoBig}[1]{\normBig{#1}_2} % l2 norm
\newcommand{\linfbigg}[1]{\normbigg{#1}_\infty} % l-infinity norm
\newcommand{\norms}[1]{\|{#1}\|} % A norm with 1 argument and normal (small)
                                 % brackets.
\newcommand{\matrixnorms}[1]{|\!|\!|{#1}|\!|\!|} % Small matrix norm
\newcommand{\matrixnormbigg}[1]{\bigg|\!\bigg|\!\bigg|{#1}\bigg|\!\bigg|\!\bigg|} % Small matrix norm
\newcommand{\lones}[1]{\norms{#1}_1} % l1 norm with small brackets
\newcommand{\ltwos}[1]{\norms{#1}_2} % l2 norm with small brackets
\newcommand{\ltwob}[1]{\big\|#1\big\|_2}
\newcommand{\linfs}[1]{\norms{#1}_\infty} % l-infinity norm with small brackets
\newcommand{\lzeros}[1]{\norms{#1}_0} % l0 norm with small brackets
\newcommand{\lambdamax}[1]{\lambda_{\max}({#1})}
\newcommand{\lambdamin}[1]{\lambda_{\min}({#1})}
\newcommand{\vmax}[1]{v_{\max}({#1})}
\newcommand{\vmin}[1]{v_{\min}({#1})}

\renewcommand{\cO}{\mathcal{O}}
\newcommand{\tO}{\widetilde{\cO}}
\newcommand{\wt}{\widetilde}
% \newcommand{\indic}[1]{\mathbf{1}\left\{#1\right\}} % Indicator function
% \newcommand{\indic}[1]{1_{#1}}
\newcommand{\indic}[1]{1\{#1\}}
\newcommand{\indics}[1]{1\{#1\}} % Indicator function small
% \newcommand{\bindic}[1]{\mathbf{1}\left\{#1\right\}} % Indicator
% function

\newcommand{\<}{\left\langle}
\renewcommand{\>}{\right\rangle}

\newcommand{\sign}{\operatorname{sign}}

\renewcommand{\bM}{\mathbf{M}}
\renewcommand{\bN}{\mathbf{N}}
\renewcommand{\bQ}{\mathbf{Q}}
\renewcommand{\bP}{\mathbf{P}}

\renewcommand{\vec}{{\rm vec}}

\newcommand{\relu}{\mathrm{ReLU}}

\newcommand{\red}[1]{{\color{red} {#1}}}
\newcommand{\blue}[1]{{\color{blue} {#1}}}


\newenvironment{talign}
 {\let\displaystyle\textstyle\align}
 {\endalign}
\newenvironment{talign*}
 {\let\displaystyle\textstyle\csname align*\endcsname}
 {\endalign}
 
%%%%%%%%%%%%%%%%%%%% Notation for transformers %%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\Hzero}{\bH^{(0)}}
\newcommand{\bHzero}{\bH^{(0)}}
\newcommand{\wzero}{w^{(0)}}
\newcommand{\wone}{w^{(1)}}
\newcommand{\Hone}{\bH^{(1)}}
\newcommand{\lth}{{(\ell)}}
\newcommand{\ltop}{{(\ell)\top}}
\newcommand{\lpth}{{(\ell+1)}}
\newcommand{\lmth}{{(\ell-1)}}
\newcommand{\Lth}{{(L)}}
\newcommand{\Lpth}{{(L+1)}}
\newcommand{\zeroth}{{(0)}}
% \newcommand{\sursf}{\widehat{\mathbf{\sigma}_{\rm S}}}
\newcommand{\sursf}{\sigma}
% \newcommand{\Attn}{\mathbf{Attn}}
\newcommand{\Attn}{{\rm Attn}}
\newcommand{\MAttn}{{\rm MAttn}}
\newcommand{\AN}{{\rm AN}}
\newcommand{\TF}{{\rm TF}}
\newcommand{\DTF}{{\rm DTF}}
\newcommand{\DTFz}{{\rm DTF}^0}
\newcommand{\TFz}{{\rm TF}^0}
\newcommand{\TFzr}{{\rm TF}^{0,R}}
\newcommand{\TFr}{{\rm TF}^{R}}
\newcommand{\hatw}{\hat{w}}

% \newcommand{\barsig}{\overline{\sigma}}
\newcommand{\barsig}{\sigma}
\newcommand{\Bh}{B_h}
\newcommand{\Bv}{B_v}
\newcommand{\Bx}{B_x}
\newcommand{\By}{B_y}
\newcommand{\Bw}{B_w}
\newcommand{\Bws}{B_w^\star}
\newcommand{\Bwstar}{B_w^\star}
\newcommand{\oBwstar}{\overline{\Bwstar}}
\newcommand{\Bwop}{B_w^{{\rm op}}}
\newcommand{\Bbarsig}{B_{\barsig}}
\newcommand{\Lbarsig}{L_{\barsig}}
\renewcommand{\dh}{{d_h}}
\newcommand{\bzero}{{\mathbf 0}}
\newcommand{\bone}{{\mathbf 1}}



\newcommand{\Closs}{C_{\ell}}
\newcommand{\Cf}{C_f}
\newcommand{\epsapp}{\epsilon_{\rm approx}}
\newcommand{\epsgen}{\epsilon_{\rm gen}}
\newcommand{\hw}{\hat{\bw}}
\newcommand{\tw}{\widetilde{\bw}}
\newcommand{\htheta}{{\hat{\theta}}}
\newcommand{\fpred}{f_{\sf pred}}

\newcommand{\condbr}[2]{\left[\left. #1\right|#2\right]}

\newcommand{\pgd}{\mathrm{PGD}}
\newcommand{\Lip}{\mathrm{Lip}}
\newcommand{\Ball}{\mathsf{B}}


\newcommand{\NNloss}{\mathsf{Loss}}
\newcommand{\loss}{\mathsf{loss}}
\newcommand{\Licl}{L_{{\sf icl}}}
\newcommand{\hLicl}{\hat{L}_{{\sf icl}}}
\newcommand{\licl}{\ell_{{\sf icl}}}
\newcommand{\from}{\leftarrow}
\newcommand{\hE}{\hat{\mathbb{E}}}
\newcommand{\clip}{\mathsf{clip}}
\newcommand{\clp}{\mathsf{clip}}
\newcommand{\hnrm}[1]{\nrm{#1}_{2,\infty}}
\newcommand{\Pin}{\mathsf{P}}
\newcommand{\pin}{\mathsf{p}}

\newcommand{\ltwop}[1]{\nrm{#1}_{2,p}}
\newcommand{\ltwoinf}[1]{\nrm{#1}_{2,\infty}}

\renewcommand{\read}{{\sf read}}
\newcommand{\readin}{{\sf readin}}
\newcommand{\readout}{{\sf readout}}
\newcommand{\readw}{{\sf read}_{\sf w}}
\newcommand{\ready}{{\sf read}_{\sf y}}
\newcommand{\readyj}{{\sf read}_{{\sf y}, j}}
\newcommand{\tready}{\wt{\sf read}_{\sf y}}
\newcommand{\treadw}{\wt{\sf read}_{\sf w}}
\newcommand{\gd}{{\rm GD}}
\newcommand{\ridge}{{\rm ridge}}
\newcommand{\lr}{{\rm LS}}
\newcommand{\ls}{{\rm LS}}


\newcommand{\hbeta}{\hat{\mathbf{\beta}}}
\newcommand{\tbeta}{\wt{\mathbf{\beta}}}
\newcommand{\tfout}{{\mathrm{out}}}
\newcommand{\Rk}[1]{R_k\big(#1\big)}
\newcommand{\hR}[1]{\hat{R}\big(#1\big)}
\newcommand{\Ek}[1]{\EE_k\Big[#1\Big]}

\newcommand{\ws}{\bw^\star}
\newcommand{\hws}{\bw_{\lasso}}
\newcommand{\normal}{\mathsf{N}}

\newcommand{\nrmp}[1]{{\left|\!\left|\!\left|{#1}\right|\!\right|\!\right|}}
\newcommand{\nrmps}[1]{{|\!|\!|{#1}|\!|\!|}}
\newcommand{\MLP}{\mathrm{MLP}}

\newcommand{\Plin}{\Pin^{\sf lin}}
\newcommand{\Pgm}{\Pin^{\sf loc}}
\newcommand{\Ploc}{\Pin^{\sf loc}}
\newcommand{\Plogin}{\Pin^{\sf log}}
\newcommand{\Pglmin}{\Pin^{\sf glm}}
\newcommand{\Elin}{E^{\sf lin}}
\newcommand{\Psilin}{\Psi^{\sf lin}}
\newcommand{\Psibin}{\Psi^{\sf binary}}
\newcommand{\Psibinth}{\Psi^{\sf binary}_{\sf thres}}
\newcommand{\lammin}{\lambda_{\min}}
\newcommand{\lammax}{\lambda_{\max}}
\newcommand{\dmem}{d_{\rm mem}}
\newcommand{\train}{{\sf train}}
% \newcommand{\val}{{\sf val}}
\newcommand{\val}{{\tt Val}}
\newcommand{\res}{{\tt Res}}

\newcommand{\test}{{\sf test}}
\newcommand{\ms}{{\sf ms}}
\newcommand{\gap}{{\sf gap}}
\def\SG{{\rm SG}}
\def\beps{{\boldsymbol \eps}}
\def\oL{{\overline L}}
\def\omu{{\overline \mu}}
\def\okappa{{\overline \kappa}}
\def\SE{{\rm SE}}
\def\App{{\rm App}}
\def\Gen{{\rm Gen}}

\newcommand{\hbtheta}{\hat{\btheta}}
\newcommand{\ThetaLMB}{\Theta_{L,M,D',B}}
\newcommand{\ThetaLMDB}{\Theta_{L,M,D',B}}

\newcommand{\out}{\mathrm{out}}
\newcommand{\clog}{\iota}

% \newcommand{\nrmp}[1]{\nrm{#1}_p}
\newcommand{\tbh}{\wt{\bh}}
\newcommand{\tbH}{\wt{\bh}}
\newcommand{\bigabs}[1]{\big|#1\big|}
% \cfn{change to op norm}

\newcommand{\linkf}{g}
\newcommand{\Clink}{L_g}
\newcommand{\clink}{\mu_g}
\newcommand{\wsim}{\bw_{\rm GLM}}
\newcommand{\Bsig}{B_{\mu}}
\newcommand{\kp}{{k+1}}
\newcommand{\barg}{\bar{g}}
\newcommand{\oU}{\overline{U}}
\newcommand{\oX}{\overline{X}}

\newcommand{\TFas}{{\tt TF\_alg\_select}}
\newcommand{\TFnoiseone}{{\tt TF\_noise\_1}}
\newcommand{\TFnoisetwo}{{\tt TF\_noise\_2}}
\newcommand{\TFreg}{{\tt TF\_reg}}
\newcommand{\TFcls}{{\tt TF\_cls}}
\newcommand{\ridgelamone}{{\tt ridge\_lam\_1}}
\newcommand{\ridgelamtwo}{{\tt ridge\_lam\_2}}
\newcommand{\LS}{{\tt Least Squares}}
\newcommand{\LR}{{\tt Logistic Regression}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\bAtt}{\btheta_{\tt attn}}
\newcommand{\bMAtt}{\btheta_{\tt mattn}}
\newcommand{\bthetamlp}{\btheta_{\tt mlp}}
\newcommand{\bmlp}{\bthetamlp}
\newcommand{\batt}{\bAtt}
\newcommand{\mlp}{{\tt mlp}}
\newcommand{\attn}{{\tt attn}}
\newcommand{\ttheta}{\wt{\btheta}}
\newcommand{\tbatt}{\theta_{\attn}'}
\newcommand{\tbmlp}{\theta_{\mlp}'}
\newcommand{\rope}{\tt ROPE}
\newcommand{\massived}{Massive tokens}
\newcommand{\sinkt}{Sink tokens}
\newcommand{\dormantt}{Dormant tokens}
\newcommand{\delim}{delimiter}
\newcommand{\llama}{Llama-2}
\newcommand{\embd}{{\tt ebd}}
\newcommand{\query}{{\tt Qry}}
\newcommand{\key}{{\tt Key}}
\newcommand{\vall}{{\tt Val}}
\newcommand{\transit}{{\sf P}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\pad}{{\sf pad}}

\newcommand{\lasso}{\mathrm{lasso}}
\newcommand{\hLN}{\hat{L}_\lasso}
\newcommand{\Llasso}{\hat{L}_{\lasso}}

\newcommand{\wst}{\bw_{\star}}

\newcommand{\Risk}{L}
\newcommand{\hRisk}{\hat{L}_{\val}}
\newcommand{\conv}{{\rm conv}}
\newcommand{\Bayesrisk}{{\sf BayesRisk}}

\newcommand{\bHin}{\bH_{\sf in}}
\newcommand{\bSigmaP}{\bSigma_{\Pin}}
\newcommand{\hSigma}{\hat{\bSigma}}
\newcommand{\bwstarP}{\bw^\star_{\Pin}}

\newcommand{\ks}{k^{\star}}
\newcommand{\Ecov}{E_{\rm cov}}
\newcommand{\Ew}{E_{w}}

\newcommand{\epsstat}{\epsilon_{\mathrm{stat}}}

\newcommand{\MSK}{{\rm MSK}}
\mathchardef\mhyphen="2D
\newcommand{\Lfitw}{L_{{\sf fit}\mhyphen {\sf w}}}

\newcommand{\hSigmak}{\hSigma_{k}}
\newcommand{\hmuk}{\hat{\bmu}_{k}}

% \newcommand{\sigmoid}{{\rm sigmoid}}
\newcommand{\sigmoid}{\sigma_{\sf sigmoid}}
\newcommand{\logistic}{{\rm log}}
\newcommand{\bin}{{\rm bin}}
\newcommand{\bDelta}{{\boldsymbol \Delta}}

\newcommand{\epsz}{\underline{\epsilon}}

\newcommand{\ty}{\wt{y}}

\newcommand{\Lval}{L_{\val}}
\newcommand{\Lvalst}{L_{\val,\wst}}
\newcommand{\Risktr}{{\sf Risk}_{k,\train}}
\newcommand{\epsval}{\eps_{\val}}
\newcommand{\Rad}{{\sf R}}

\newcommand{\usig}{\sigma_{\min}}
\newcommand{\osig}{\sigma_{\max}}
\newcommand{\obx}{\overline{\bx}}
\newcommand{\oy}{\overline{y}}
\newcommand{\obz}{\bar{\bz}}
\newcommand{\oz}{\overline{z}}

\newcommand{\bpO}[1]{O\paren{#1}}
\newcommand{\tpO}[1]{\widetilde{O}\paren{#1}}

\newcommand{\actv}{r}
\newcommand{\pred}{\mathrm{pred}}

\newcommand{\Nt}{N_{\sf train}}
\newcommand{\Nv}{N_{\sf val}}
\newcommand{\bXt}{\bX_{\sf train}}
\newcommand{\bXv}{\bX_{\sf val}}
\newcommand{\cDt}{\cD_{\sf train}}
\newcommand{\cDv}{\cD_{\sf val}}
\newcommand{\cEt}{\cE_{\sf train}}
\newcommand{\cEv}{\cE_{\sf val}}
\newcommand{\cIt}{\cI_{\sf train}}
\newcommand{\cIv}{\cI_{\sf val}}

\newcommand{\lphalf}{\ell+\frac{1}{2}}
\newcommand{\gm}{{\sf G}}
\newcommand{\Gweta}{{\sf G}^f_{\cW, \eta}}
\newcommand{\GwLneta}{{\sf G}^{\hat{L}_N}_{\cW, \eta}}

\newcommand{\epsN}{\omega_N}

\newcommand{\hf}{\hat{f}}
\newcommand{\hy}{\hat{y}}

\newcommand{\softmax}{{\sf SoftMax}}
\newcommand{\mask}{{\sf mask}}
\def\period{{{$\langle${$\mathtt{period}$}$\rangle$}}}


% New commands for dormant head:
% names
\newcommand{\attnsink}{attention sink}
\newcommand{\valuedrain}{value-state drain}
\newcommand{\respeak}{residual-state peak}

\newcommand{\domattn}{dominant attention}
\newcommand{\smallvalue}{small value-state}
\newcommand{\massiveres}{massive residual-state}

\newcommand{\activedormant}{active-dormant mechanism}


% math commands in dormant head
\newcommand{\seqlen}{N}
\newcommand{\vocab}{\mathcal{V}}
\newcommand{\vocabsize}{V}
\newcommand{\tok}{v}
\newcommand{\toki}{i}
\newcommand{\tokn}{n}
\newcommand{\tokk}{k}
\newcommand{\tokj}{j}

\newcommand{\sink}{\alpha}
\newcommand{\vecvalue}{\boldsymbol{\beta}}
\newcommand{\ivalue}{\beta}
\newcommand{\transition}{p}
\newcommand{\Transition}{\bP}
\newcommand{\ppred}{l}
\newcommand{\Ppred}{\mathbf{L}}
\newcommand{\Output}{\textsc{Output}}
\newcommand{\q}{q}
\newcommand{\stable}{\pi}
\newcommand{\toksup}{{(\tok)}}
\newcommand{\tokisup}{{(\toki)}}
\newcommand{\tokksup}{{(\tokk)}}
\newcommand{\vecsink}{\bm{\sink}}
\newcommand{\meanvalue}{\bar{B}}
\newcommand{\inv}{{-1}}
\newcommand{\gppred}{\bG}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\bb}{Bigram-Backcopy}
\newcommand{\Pos}{\texttt{Pos}}

\newcommand{\hiddenstate}{\bm{h}}
\newcommand{\hiddenstates}{\bm{H}}
\newcommand{\lnm}{\text{LayerNorm}}

\newcommand{\mass}{M}

\newcommand\blfootnote[1]{
    \begingroup
    \renewcommand\thefootnote{}\footnote{#1}
    \addtocounter{footnote}{-1}
    \endgroup
}