% Based on the NeurIPS 2024 example, at https://neurips.cc/Conferences/2024/CallForPapers
\documentclass{article}


%%%%%%%%%%%
% Imports %
%%%%%%%%%%%

\usepackage[numbers]{natbib}
\usepackage[preprint]{arXiv/neurips_2024}  % File modified ("<<< CB edit")
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{url}
\usepackage{booktabs}
\usepackage{amsfonts}
\usepackage{nicefrac}
\usepackage{microtype}
\usepackage[dvipsnames]{xcolor}
\usepackage[para, bottom]{footmisc}
\usepackage{subcaption}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{multirow}
\usepackage{makecell}
\usepackage[frozencache=true,cachedir=minted-cache]{minted} 
\usepackage[hyperfootnotes=false]{hyperref}  % hyperfootnotes=false removes annoying footnote links
\usepackage{cleveref}
\usepackage{wrapfig}
\usepackage{bm}  % bold math
\usepackage{mathtools}  % dcases
\usepackage{amsthm}  % proof environment
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{placeins}  % \FloatBarrier
\usepackage{listings}


%%%%%%%%%%%%%%%%%%%
% Custom commands %
%%%%%%%%%%%%%%%%%%%

\newcommand{\mup}{µP}
\newcommand{\umup}{u-\mup}
\newcommand{\umupcol}{{\color{ForestGreen} u-}\mup}
\newcommand{\depthmup}{depth-µP}
\newcommand{\mut}{µTransfer}
\newcommand{\mutable}{µTransferable}
\newcommand{\mutacross}{µTransferred-across}

\newcommand{\fanin}{\mathrm{fan{\text -}in}}
\newcommand{\fanout}{\mathrm{fan{\text -}out}}
\newcommand{\depth}{\mathrm{depth}}
\newcommand{\basewidth}{\mathrm{base{\text -}width}}
\newcommand{\basefanin}{\mathrm{base{\text -}fan{\text -}in}}
\newcommand{\basefanout}{\mathrm{base{\text -}fan{\text -}out}}
\newcommand{\basedepth}{\mathrm{base{\text -}depth}}
\newcommand{\initstd}{\sigma_{\mathrm{init}}}
\newcommand{\one}{\scriptstyle{1}}
\newcommand{\batchsize}{\mathrm{batch{\text -}size}}

% For coloured commands, pick from https://sharelatex-wiki-cdn-671420.c.cdn77.org/learn-scripts/images/e/ef/OLxcolorList2.png
\newcommand{\want}[1]{#1}
\newcommand{\todo}[1]{{\color{Red}[TODO] #1}}
\newcommand{\todocite}{{\color{Gray}[ref]}}
\newcommand{\todofig}{{\color{Gray}(TODO: figure)}}
\newcommand{\plot}[1]{{\color{Blue}[Proposed Plot] #1}}
\newcommand{\plota}[1]{{\color{CadetBlue}[Proposed Plot (appdx)] #1}}
\newcommand{\cb}[1]{{\color{Thistle}[CB] #1}}
\newcommand{\lyp}[1]{{\color{Cerulean}[LYP] #1}}
\newcommand{\jd}[1]{{\color{Plum}[JD] #1}}
\newcommand{\daho}[1]{{\color{OliveGreen}[DAHO] #1}}
\newcommand{\ce}[1]{{\color{SeaGreen}[CE] #1}}
\newcommand{\fc}[1]{{\color{Orange}[FC] #1}}

% Mathematical
\newtheorem{thm}{Theorem}[section]
\newtheorem{prop}[thm]{Proposition}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{defn}[thm]{Definition}
\newtheorem{rem}[thm]{Remark}

\newcommand{\N}{\mathbb{N}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Prob}{\mathbb{P}}

% For minted code figures
\usemintedstyle{xcode}
\definecolor{LightGray}{gray}{0.98}
\newcommand{\codefig}[1]{
    \inputminted[
        fontsize=\small, bgcolor=LightGray, python3=true, xleftmargin=1em
    ]{python}{arXiv/code/#1}
    \vspace{-0.6cm}
}


%%%%%%%%%%%%%%%%%%%
% Title & Authors %
%%%%%%%%%%%%%%%%%%%

\title{\umup: The Unit-Scaled Maximal Update Parametrization}

\author{%
  Charlie Blake\thanks{Equal contribution.} \\
  Graphcore \\
  \And
  Constantin Eichenberg\footnotemark[1] \\
  Aleph Alpha \\
  \And
  Josef Dean \\
  Graphcore \\
  \And
  Lukas Balles \\
  Aleph Alpha \\
  \And
  Luke Y. Prince \\
  Graphcore \\
  \And
  Björn Deiseroth \\
  Aleph Alpha \\
  \And
  Andres Felipe\thanks{Work done while at Aleph Alpha.}\\\textbf{Cruz-Salinas} \\
  Cohere \\
  \And
  Carlo Luschi\thanks{Supervisory role.\\Correspondence to: \href{mailto:charlieb@graphcore.ai}{charlieb@graphcore.ai}, \href{mailto:constantin.eichenberg@aleph-alpha-ip.ai}{constantin.eichenberg@aleph-alpha-ip.ai}.} \\
  Graphcore \\
  \And
  Samuel Weinbach\footnotemark[3] \\
  Aleph Alpha \\
  \And
  Douglas Orr \\
  Graphcore \\
}


%%%%%%%%%%%%
% Document %
%%%%%%%%%%%%

\begin{document}
\maketitle
\setcounter{footnote}{0}
\vspace{-2em}

\input{arXiv/sections/0_abstract}
\input{arXiv/sections/1_introduction}
\input{arXiv/sections/2_background}
\input{arXiv/sections/3_the_challenges_with_mup}
\input{arXiv/sections/4_the_unit-scaled_maximal_update_parametrization}
\input{arXiv/sections/5_experiments}
\input{arXiv/sections/6_related_work}
\input{arXiv/sections/7_conclusions}

\clearpage
\bibliographystyle{unsrt}
\bibliography{main_arxiv}
\clearpage
% \setcounter{tocdepth}{1}
\tableofcontents
\clearpage
\newpage
\appendix

\input{arXiv/sections/A_additional_experiments}
\input{arXiv/sections/B_additional_unit_scaled_ops}
\input{arXiv/sections/C_a_guide_to_using_umup}
\input{arXiv/sections/D_a_guide_to_the_unit_scaling_library}
\input{arXiv/sections/E_additional_background_material}
\input{arXiv/sections/F_unit_scaled_pre_norm_residual_layers}
\input{arXiv/sections/G_hyperparameters_for_umup}
\input{arXiv/sections/H_the_cut_edge_rule}
\input{arXiv/sections/I_from_mup_to_umup}
\input{arXiv/sections/J_low_precision_and_its_tradeoffs}
\input{arXiv/sections/K_scaled_mm_benchmarking}
\input{arXiv/sections/L_scale_growth_with_depth}

\end{document}