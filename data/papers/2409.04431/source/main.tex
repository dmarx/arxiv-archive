
\documentclass{article}

\input{preamble}

\usepackage{titletoc}
\usepackage[page,header]{appendix}
\usepackage{setspace}
\noappendicestocpagenum

\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{booktabs} %

\usepackage{xcolor}
\definecolor{lm_core_en}{rgb}{0.7137,0.3333,0.3333}
\definecolor{lm_code}{rgb}{0.4118,0.6431,0.4314}
\definecolor{lm_math}{rgb}{0.3254,0.4431,0.6666}


\usepackage{hyperref}
\hypersetup{
    colorlinks,
    linkcolor={black!10!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}


\newcommand{\theHalgorithm}{\arabic{algorithm}}


\usepackage[preprint]{neurips_2024}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}

\usepackage{adjustbox}

\usepackage{titlesec}
\titlespacing{\paragraph}{0pt}{0pt}{1em} %

\usepackage[nameinlink]{cleveref}
\usepackage{enumitem}
\setlist[enumerate,1]{label=(\arabic*),ref=(\arabic*)}
\setlist[enumerate,2]{label=(\alph*),ref=(\arabic{enumi}-\alph*)}
\crefname{enumi}{Step}{Steps}     %
\crefformat{equation}{(#2#1#3)} %
\crefmultiformat{equation}{(#2#1#3)}%
{ and~(#2#1#3)}{, (#2#1#3)}{ and~(#2#1#3)}

\crefname{section}{Sec.}{Sec.}
\Crefname{section}{Section}{Sections}
\crefname{appendix}{App.}{App.}
\Crefname{appendix}{Appendix}{Appendices}
\crefname{table}{Tab.}{Tab.}
\Crefname{table}{Table}{Tables}
\crefname{figure}{Fig.}{Fig.}
\Crefname{figure}{Figure}{Figures}
\crefname{algorithm}{Alg.}{Alg.}
\Crefname{algorithm}{Algorithm}{Algorithms}
\crefname{theorem}{Thm.}{Thm.}
\Crefname{theorem}{Theorem}{Theorems}
\crefname{lemma}{Lemma}{Lemmas}
\Crefname{lemma}{Lemma}{Lemmas}
\crefname{definition}{Def.}{Def.}
\Crefname{definition}{Definition}{Definitions}
\crefname{remark}{Rmk.}{Rmk.}
\Crefname{remark}{Remark}{Remarks}


\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

\usepackage{multirow}
\usepackage{multicol}
\newcommand*\rot{\rotatebox{90}}

\usepackage[textsize=tiny]{todonotes}


\title{Theory, Analysis, and Best Practices for \\ Sigmoid Self-Attention}

\newcommand*\samethanks[1][\value{footnote}]{\footnotemark[#1]}

\author{
  Jason Ramapuram\thanks{Primary contributor. For a detailed breakdown of author contributions see \Cref{sec:attribution}.}
  \And
  Federico Danieli\samethanks
  \And 
  Eeshan Dhekane\samethanks \And
  Floris Weers\samethanks \And
  Dan Busbridge\samethanks \And
  Pierre Ablin\samethanks \And  
  Tatiana Likhomanenko\samethanks \AND
  Jagrit Digani \And
  Zijin Gu \And
  Amitis Shidani \And
  Russ Webb \And
  \vspace{-0.5cm} \\ \phantom{Mystery} \\
  Apple \\ \\
  \footnotesize\texttt{\{jramapuram, f\_danieli, eeshan, floris\_weers, dbusbridge,} \\
  \footnotesize\texttt{p\_ablin, antares, digani, zgu26, amitis\_shidani, rwebb\}@apple.com} \\
\\
}

\begin{document}

\maketitle

\input{body/abstract.tex}
\input{body/introduction.tex}
\input{body/methods.tex}
\input{body/theory.tex}
\input{appendix/computational_complexity}
\input{body/_flash_content.tex}
\input{body/experiments.tex}
\input{body/related.tex}
\input{body/conclusion.tex}
\input{body/acknowledgements}

\bibliography{example_paper}
\bibliographystyle{icml2024}


\newpage
\appendix
\startcontents[sections]
\printcontents[sections]{l}{1}
\appendixpage
\clearpage
\input{appendix/limitations_and_broader_impact}
\input{appendix/uap.tex}
\input{appendix/lipschitz.tex}
\input{appendix/sigmoid_bias}
\input{appendix/_flash_appendix}
\input{appendix/experiments}
\input{appendix/simple_experiments}
\input{appendix/attribution}



\end{document}
